"use strict";(globalThis.webpackChunkgratitude_token_project_docs=globalThis.webpackChunkgratitude_token_project_docs||[]).push([[6710],{8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},l=s.createContext(i);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},8513:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"DEPLOYMENT_ISSUE_FIX","title":"\ud83d\udc1b Main dApp Deployment Issue - Root Cause & Fix","description":"\ud83d\udccb Problem Summary","source":"@site/docs/DEPLOYMENT_ISSUE_FIX.md","sourceDirName":".","slug":"/DEPLOYMENT_ISSUE_FIX","permalink":"/gratitude-token-project_docs/docs/DEPLOYMENT_ISSUE_FIX","draft":false,"unlisted":false,"editUrl":"https://github.com/drasticstatic/gratitude-token-project_docs/tree/main/docs/DEPLOYMENT_ISSUE_FIX.md","tags":[],"version":"current","frontMatter":{}}');var i=t(4848),l=t(8453);const r={},a="\ud83d\udc1b Main dApp Deployment Issue - Root Cause & Fix",d={},c=[{value:"\ud83d\udccb Problem Summary",id:"-problem-summary",level:2},{value:"\ud83d\udd0d Root Cause Analysis",id:"-root-cause-analysis",level:2},{value:"Issue 1: Missing React Router <code>basename</code>",id:"issue-1-missing-react-router-basename",level:3},{value:"Issue 2: 404.html Redirect Logic",id:"issue-2-404html-redirect-logic",level:3},{value:"Issue 3: index.html Redirect Handler",id:"issue-3-indexhtml-redirect-handler",level:3},{value:"\u2705 Complete Fix Implementation",id:"-complete-fix-implementation",level:2},{value:"Step 1: Update src/index.js",id:"step-1-update-srcindexjs",level:3},{value:"Step 2: Create/Update public/404.html",id:"step-2-createupdate-public404html",level:3},{value:"Step 3: Update public/index.html",id:"step-3-update-publicindexhtml",level:3},{value:"Step 4: Verify package.json",id:"step-4-verify-packagejson",level:3},{value:"Step 5: Rebuild and Redeploy",id:"step-5-rebuild-and-redeploy",level:3},{value:"\ud83e\uddea Testing Checklist",id:"-testing-checklist",level:2},{value:"\ud83d\udcdd Why This Happens",id:"-why-this-happens",level:2},{value:"GitHub Pages Subdirectory Deployment",id:"github-pages-subdirectory-deployment",level:3},{value:"Without These Fixes",id:"without-these-fixes",level:3},{value:"\ud83d\udd04 Update deployTest.sh",id:"-update-deploytestsh",level:2},{value:"\ud83c\udfaf Priority Actions",id:"-priority-actions",level:2},{value:"Immediate (Do Now)",id:"immediate-do-now",level:3},{value:"Short-term (Next)",id:"short-term-next",level:3},{value:"Long-term (Future)",id:"long-term-future",level:3},{value:"\ud83d\udcda References",id:"-references",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"-main-dapp-deployment-issue---root-cause--fix",children:"\ud83d\udc1b Main dApp Deployment Issue - Root Cause & Fix"})}),"\n",(0,i.jsx)(n.h2,{id:"-problem-summary",children:"\ud83d\udccb Problem Summary"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Issue:"})," Site deployed to ",(0,i.jsx)(n.code,{children:"https://drasticstatic.github.io/gratitude-token-project_testPublish_2025-10-10/"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Loads with only navbar and background (no content)"}),"\n",(0,i.jsxs)(n.li,{children:["Clicking home button redirects to ",(0,i.jsx)(n.code,{children:"https://drasticstatic.github.io"})," (wrong URL)"]}),"\n",(0,i.jsx)(n.li,{children:"Home page renders correctly at wrong URL"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," \ud83d\udd34 CRITICAL - Needs immediate fix"]}),"\n",(0,i.jsx)(n.h2,{id:"-root-cause-analysis",children:"\ud83d\udd0d Root Cause Analysis"}),"\n",(0,i.jsxs)(n.h3,{id:"issue-1-missing-react-router-basename",children:["Issue 1: Missing React Router ",(0,i.jsx)(n.code,{children:"basename"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"src/index.js"})," (Line 97)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Current Code:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"<Router>\n  {/* Routes */}\n</Router>\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem:"})," React Router doesn't know it's deployed to a subdirectory"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix Required:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"<Router basename={process.env.PUBLIC_URL}>\n  {/* Routes */}\n</Router>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"issue-2-404html-redirect-logic",children:"Issue 2: 404.html Redirect Logic"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"public/404.html"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Current Status:"})," May not exist or may have incorrect redirect logic"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Required 404.html:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Ethereal Offering</title>\n    <script type=\"text/javascript\">\n      // Single Page Apps for GitHub Pages\n      // https://github.com/rafgraph/spa-github-pages\n      var pathSegmentsToKeep = 1;\n      var l = window.location;\n      l.replace(\n        l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +\n        l.pathname.split('/').slice(0, 1 + pathSegmentsToKeep).join('/') + '/?/' +\n        l.pathname.slice(1).split('/').slice(pathSegmentsToKeep).join('/').replace(/&/g, '~and~') +\n        (l.search ? '&' + l.search.slice(1).replace(/&/g, '~and~') : '') +\n        l.hash\n      );\n    <\/script>\n  </head>\n  <body>\n  </body>\n</html>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"issue-3-indexhtml-redirect-handler",children:"Issue 3: index.html Redirect Handler"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File:"})," ",(0,i.jsx)(n.code,{children:"public/index.html"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Required Addition:"})," Add redirect handler script before closing ",(0,i.jsx)(n.code,{children:"</head>"})," tag"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:"<script type=\"text/javascript\">\n  // Single Page Apps for GitHub Pages\n  // https://github.com/rafgraph/spa-github-pages\n  (function(l) {\n    if (l.search[1] === '/' ) {\n      var decoded = l.search.slice(1).split('&').map(function(s) { \n        return s.replace(/~and~/g, '&')\n      }).join('?');\n      window.history.replaceState(null, null,\n          l.pathname.slice(0, -1) + decoded + l.hash\n      );\n    }\n  }(window.location))\n<\/script>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-complete-fix-implementation",children:"\u2705 Complete Fix Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-update-srcindexjs",children:"Step 1: Update src/index.js"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add basename to Router:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Line 97 - Update Router component\nfunction App() {\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n      {/* Visual Effects - Applied to all pages */}\n      <DynamicPagePadding />\n      <Sparkles />\n      <CursorTrail />\n      <SporeContainer />\n\n      <Navigation />\n      <Routes>\n        <Route path="/" element={<LandingPage />} />\n        <Route path="/daily-shrooms" element={<DailyShrooms />} />\n        <Route path="/cross-breeding" element={<CrossBreeding />} />\n        <Route path="/governance" element={<Governance />} />\n        <Route path="/altar" element={<AltarBurn />} />\n        <Route path="/donate" element={<Donate />} />\n        <Route path="/swap" element={<Swap />} />\n        <Route path="/contact" element={<Contact />} />\n        <Route path="/admin" element={<AdminPanel />} />\n      </Routes>\n    </Router>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-createupdate-public404html",children:"Step 2: Create/Update public/404.html"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create file:"})," ",(0,i.jsx)(n.code,{children:"public/404.html"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Ethereal Offering</title>\n    <script type=\"text/javascript\">\n      // Single Page Apps for GitHub Pages\n      // https://github.com/rafgraph/spa-github-pages\n      var pathSegmentsToKeep = 1;\n      var l = window.location;\n      l.replace(\n        l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +\n        l.pathname.split('/').slice(0, 1 + pathSegmentsToKeep).join('/') + '/?/' +\n        l.pathname.slice(1).split('/').slice(pathSegmentsToKeep).join('/').replace(/&/g, '~and~') +\n        (l.search ? '&' + l.search.slice(1).replace(/&/g, '~and~') : '') +\n        l.hash\n      );\n    <\/script>\n  </head>\n  <body>\n  </body>\n</html>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-update-publicindexhtml",children:"Step 3: Update public/index.html"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Add redirect handler before closing ",(0,i.jsx)(n.code,{children:"</head>"})," tag:"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="utf-8" />\n    <link rel="icon" href="%PUBLIC_URL%/images/EO.png" />\n    <meta name="viewport" content="width=device-width, initial-scale=1" />\n    <meta name="theme-color" content="#581c87" />\n    <meta\n      name="description"\n      content="Ethereal Offering - Burn tokens. Grow mushrooms. Shape the DAO. Experience the ritual of giving."\n    />\n    <link rel="apple-touch-icon" href="%PUBLIC_URL%/images/EO.png" />\n    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />\n    <title>Ethereal Offering \ud83c\udf0c | Sacred Economy DAO</title>\n    \n    \x3c!-- Single Page Apps for GitHub Pages --\x3e\n    <script type="text/javascript">\n      (function(l) {\n        if (l.search[1] === \'/\' ) {\n          var decoded = l.search.slice(1).split(\'&\').map(function(s) { \n            return s.replace(/~and~/g, \'&\')\n          }).join(\'?\');\n          window.history.replaceState(null, null,\n              l.pathname.slice(0, -1) + decoded + l.hash\n          );\n        }\n      }(window.location))\n    <\/script>\n  </head>\n  <body>\n    <noscript>You need to enable JavaScript to run this app.</noscript>\n    <div id="root"></div>\n  </body>\n</html>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-verify-packagejson",children:"Step 4: Verify package.json"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ensure homepage field is set correctly:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "gratitude-token-project",\n  "version": "0.1.0",\n  "homepage": "https://drasticstatic.github.io/gratitude-token-project_testPublish_2025-10-10",\n  ...\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," deployTest.sh should already be setting this automatically"]}),"\n",(0,i.jsx)(n.h3,{id:"step-5-rebuild-and-redeploy",children:"Step 5: Rebuild and Redeploy"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Clean previous build\nrm -rf build/\n\n# Rebuild with correct configuration\nnpm run build\n\n# Verify homepage in built package.json\ncat build/package.json | grep homepage\n\n# Redeploy using deployTest.sh\n./deployTest/deployTest.sh 2025-10-10\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-testing-checklist",children:"\ud83e\uddea Testing Checklist"}),"\n",(0,i.jsx)(n.p,{children:"After redeployment, verify:"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Site loads at: ",(0,i.jsx)(n.code,{children:"https://drasticstatic.github.io/gratitude-token-project_testPublish_2025-10-10/"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Home page content renders immediately"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Navbar appears correctly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Background effects work"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Clicking home button stays at correct URL"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All navigation links work"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Refreshing any page works correctly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No 404 errors"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Favicon displays correctly"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-why-this-happens",children:"\ud83d\udcdd Why This Happens"}),"\n",(0,i.jsx)(n.h3,{id:"github-pages-subdirectory-deployment",children:"GitHub Pages Subdirectory Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["When deploying to ",(0,i.jsx)(n.code,{children:"username.github.io/repo-name/"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"React Router needs basename"})," - Tells router the app is not at root"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"404.html needed"})," - GitHub Pages serves 404 for client-side routes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Redirect script needed"})," - Converts 404 to proper route"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PUBLIC_URL must be set"})," - For asset paths (done by homepage field)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"without-these-fixes",children:"Without These Fixes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Router thinks it's at ",(0,i.jsx)(n.code,{children:"https://drasticstatic.github.io/"})," (root)"]}),"\n",(0,i.jsxs)(n.li,{children:["Clicking home navigates to ",(0,i.jsx)(n.code,{children:"/"})," which is ",(0,i.jsx)(n.code,{children:"https://drasticstatic.github.io/"})]}),"\n",(0,i.jsx)(n.li,{children:"Direct navigation to routes gets 404 from GitHub"}),"\n",(0,i.jsx)(n.li,{children:"Assets may not load correctly"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-update-deploytestsh",children:"\ud83d\udd04 Update deployTest.sh"}),"\n",(0,i.jsx)(n.p,{children:"The deployTest.sh script should already handle most of this, but verify it includes:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Sets homepage field in package.json"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Creates 404.html"}),"\n",(0,i.jsx)(n.li,{children:"\u26a0\ufe0f May need to update index.html with redirect script"}),"\n",(0,i.jsx)(n.li,{children:"\u26a0\ufe0f May need to update src/index.js with basename"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Recommendation:"})," Update deployTest.sh to automatically:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add basename to Router in src/index.js"}),"\n",(0,i.jsx)(n.li,{children:"Add redirect script to public/index.html"}),"\n",(0,i.jsx)(n.li,{children:"Create public/404.html"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-priority-actions",children:"\ud83c\udfaf Priority Actions"}),"\n",(0,i.jsx)(n.h3,{id:"immediate-do-now",children:"Immediate (Do Now)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"src/index.js"})," - Add ",(0,i.jsx)(n.code,{children:"basename={process.env.PUBLIC_URL}"})," to Router"]}),"\n",(0,i.jsxs)(n.li,{children:["Create ",(0,i.jsx)(n.code,{children:"public/404.html"})," with redirect script"]}),"\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"public/index.html"})," with redirect handler"]}),"\n",(0,i.jsx)(n.li,{children:"Rebuild and redeploy"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"short-term-next",children:"Short-term (Next)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"deployTest.sh"})," to automate these fixes"]}),"\n",(0,i.jsx)(n.li,{children:"Test deployment thoroughly"}),"\n",(0,i.jsx)(n.li,{children:"Document in deployment guide"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"long-term-future",children:"Long-term (Future)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Consider custom domain to avoid subdirectory issues"}),"\n",(0,i.jsx)(n.li,{children:"Add automated deployment tests"}),"\n",(0,i.jsx)(n.li,{children:"Create deployment verification script"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-references",children:"\ud83d\udcda References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/rafgraph/spa-github-pages",children:"SPA GitHub Pages"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://reactrouter.com/en/main/router-components/browser-router#basename",children:"React Router Basename"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://create-react-app.dev/docs/deployment/#github-pages",children:"Create React App Deployment"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," Ready to implement",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Priority:"})," \ud83d\udd34 CRITICAL",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Estimated Time:"})," 15 minutes",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Impact:"})," Fixes broken deployment completely"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);